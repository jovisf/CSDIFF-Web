# docker-compose.yml para CSDiff-Web

version: '3.8'

services:
  csdiff-web:
    build: .
    image: csdiff-web:latest
    container_name: csdiff-web
    volumes:
      # Montar diretório de dados para persistência
      - ./data:/app/data
      # Montar código fonte para desenvolvimento (opcional)
      - ./src:/app/src
      - ./scripts:/app/scripts
      - ./examples:/app/examples
    environment:
      - SLOW_DIFF3_PATH=/opt/slow-diff3/src/index.js
      - PYTHONUNBUFFERED=1
    working_dir: /app
    command: /bin/bash
    stdin_open: true
    tty: true

  # Serviço para testes
  csdiff-web-test:
    build: .
    image: csdiff-web:latest
    container_name: csdiff-web-test
    volumes:
      - ./src:/app/src
      - ./tests:/app/tests
    environment:
      - SLOW_DIFF3_PATH=/opt/slow-diff3/src/index.js
      - PYTHONUNBUFFERED=1
    working_dir: /app
    command: pytest tests/ -v
